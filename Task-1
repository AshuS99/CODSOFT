import os


def open_file(filename, mode='r+'):
    if not os.path.exists(filename):
        with open(filename, 'w') as f:
            pass  
        print(f"{filename} did not exist, so it has been created.")
    return open(filename, mode)

def todo_list_operations(filename):
    with open_file(filename, 'r+') as file: 
        print("What do you want to do:")
        print("1. Add task")
        print("2. Delete task")
        print("3. View current to-do list")  
        try:
            c = int(input("Enter your choice: "))

            if c == 1:
                t = int(input("Enter the number of tasks you want to add: "))
                for i in range(1, t + 1):
                    task = input(f"Enter task {i}: ")
                    file.write(task + '\n') 

                file.seek(0)
                content = file.read()
                print("TO DO LIST:")
                print(content)

            elif c == 2:
                lines = file.readlines()  
                print("TO DO LIST:")
                for i, line in enumerate(lines, start=1):
                    print(f"{i}. {line.strip()}")

                l = int(input("Enter the line number of the task you want to delete: "))
                if 1 <= l <= len(lines):
                    del lines[l - 1] 
                    file.seek(0) 
                    file.truncate() 
                    file.writelines(lines) 
                    print("Updated TO DO LIST:")
                    for line in lines:
                        print(line.strip())
                else:
                    print("Invalid line number.")

            elif c == 3:  
                file.seek(0)  
                content = file.read()
                print("Current TO DO LIST:")
                print(content)

            else:
                print("Invalid choice. Please select 1, 2, or 3.")
        except ValueError:
            print("Invalid input. Please enter an integer.")

# Main program
print("1. Already have a to-do list and want to check it")
print("2. Creating it for the first time")
try:
    x = int(input("Enter your choice: "))

    if x == 1:
        n = input("Enter the file name: ")
        todo_list_operations(n)

    elif x == 2:
        filename = input("Enter list name: ")
        print(f"Creating new to-do list in {filename}")
        todo_list_operations(filename)

    else:
        print("Invalid choice. Please select 1 or 2.")

except ValueError:
    print("Invalid input. Please enter an integer.")
